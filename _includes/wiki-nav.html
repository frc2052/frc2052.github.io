<div class="wiki-sidebar-nav">
    <nav class="nav flex-column">
        <h3>2052 Wiki</h3>

        <div class="nav-item d-flex align-items-center">
            <span>
                <a href="/wiki/" class="wiki-tocchapter">Table of Contents</a>
            </span>
        </div>
        {% for chapter in site.data.wiki.chapters %}
        {% assign chapter_num = forloop.index %}
        {% assign chapter_id = "chapter-" | append: chapter_num %}
        <div class="nav-item d-flex align-items-center wiki-navchapter">
            {% if chapter.sections %}
            <button class="wiki-caret-btn btn btn-link p-0 mr-2" type="button" width="30"
                    data-toggle="collapse"
                    data-target="#{{ chapter_id }}"
                    aria-expanded="false"
                    aria-controls="{{ chapter_id }}">
                <svg class="wiki-caret" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                    <path fill-rule="evenodd" d="M6.646 12.854a.5.5 0 0 1 0-.708L10.293 8 6.646 4.354a.5.5 0 1 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708 0z" />
                </svg>
            </button>
            {% else %}
            <button class="wiki-caret-btn btn btn-link p-0 mr-2" type="button" width="30" >
                <!-- make a button with tranparent content that doesn't do anything for proper spacing-->
                <svg class="wiki-caret" width="20" height="20" fill="transparent" viewBox="0 0 16 16" aria-hidden="true">
                    <path fill-rule="evenodd" d="M6.646 12.854a.5.5 0 0 1 0-.708L10.293 8 6.646 4.354a.5.5 0 1 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708 0z" />
                </svg>
            </button>
            {% endif %}
            <span>
                {{ chapter_num }}.&nbsp;
                {% if chapter.url %}
                <a href="{{ chapter.url }}">{{ chapter.title }}</a>
                {% else %}
                <span class="wiki-tocchapter">{{ chapter.title }}</span>
                {% endif %}
            </span>
        </div>
        {% if chapter.sections %}
        <div class="collapse" id="{{ chapter_id }}">
            <nav class="nav flex-column ml-3">
                {% for section in chapter.sections %}
                {% assign section_num = forloop.index %}
                {% assign section_id = chapter_id | append: "-section-" | append: section_num %}
                <div class="nav-item d-flex align-items-center wiki-navsection">
                    {% if section.subsections %}
                    <button class="wiki-caret-btn btn btn-link p-0 mr-2" type="button"
                            data-toggle="collapse"
                            data-target="#{{ section_id }}"
                            aria-expanded="false"
                            aria-controls="{{ section_id }}">
                        <svg class="wiki-caret" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                            <path fill-rule="evenodd" d="M6.646 12.854a.5.5 0 0 1 0-.708L10.293 8 6.646 4.354a.5.5 0 1 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708 0z" />
                        </svg>
                    </button>
                    {% else %}
                    <button class="wiki-caret-btn btn btn-link p-0 mr-2" type="button" width="30">
                        <!-- make a button with tranparent content that doesn't do anything for proper spacing-->
                        <svg class="wiki-caret" width="20" height="20" fill="transparent" viewBox="0 0 16 16" aria-hidden="true">
                            <path fill-rule="evenodd" d="M6.646 12.854a.5.5 0 0 1 0-.708L10.293 8 6.646 4.354a.5.5 0 1 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708 0z" />
                        </svg>
                    </button>
                    {% endif %}
                    <div class="d-flex flex-row">
                        <div class="wiki-section-number" style="min-width: 25px;">{{ chapter_num }}.{{ section_num }}&nbsp;</div>
                        <div class="wiki-section-title" style="flex:1;">
                            {% if section.url %}
                            <a href="{{ section.url }}">{{ section.title }}</a>
                            {% else %}
                            <span>{{ section.title }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% if section.subsections %}
                <div class="collapse" id="{{ section_id }}">
                    <nav class="nav flex-column ml-3 wiki-navsubsection">
                        {% for subsection in section.subsections %}
                        {% assign subsection_letter = 'abcdefghijklmnopqrstuvwxyz' | slice: forloop.index0, 1 %}
                        <span>
                            {% if subsection.url %}
                            <a href="{{ subsection.url }}">{{ subsection.title }}</a>
                            {% else %}
                            <span>{{ subsection.title }}</span>
                            {% endif %}
                        </span>
                        {% endfor %}
                    </nav>
                </div>
                {% endif %}
                {% endfor %}
            </nav>
        </div>
        {% endif %}
        {% endfor %}
    </nav>
</div>
